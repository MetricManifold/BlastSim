
#include "curve.h"

namespace FIT
{
	double mu(double e, double rho)
	{
		rho = rho * RHO0;
		e = e * E0 * KCAL_TO_M2_PS2;

		double Y = log10(rho / RHO_CURVE), Z = log10(e / E_CURVE);
		double F, a1, a2, a3, a4, a5, a6, a7, a8, a9;

		if (Z < 0.44)
		{
			double T = 0.4 * e / 287.06;
			return 1.462e-6 * sqrt(T) / (1 + 112 / T) / MU0;
		}

		if (Z < 0.67)
		{
			a1 = 4.84547e-1 + 4.67135e-1 * Z;
			a2 = (5.71205e-4 - 1.43629e-3 * Z) * Y;
			a3 = (2.5511 - 2.33472e-4 * Y - 1.44102 * Z) * Z * Z;
			a4 = (2.53416e-4 - 4.72375e-4 * Z + 1.86899e-5 * Y) * Y * Y;
			F = a1 + a2 + a3 + a4;
		}
		else if (Z < 1.75)
		{
			a1 = -3.71666e1 + 6.67883e1 * Z;
			a2 = (-2.43998 + 2.12309 * Z) * Y;
			a3 = (-3.69259e1 - 3.08426e-1 * Y + 7.36486 * Z) * Z * Z;
			a4 = (-1.46446e-1 + 7.54423e-2 * Z - 2.91464e-3 * Y) * Y * Y;
			a5 = 3.61757e1 - 6.11102e1 * Z;
			a6 = (2.40531 - 2.05914 * Z) * Y;
			a7 = (3.23911e1 + 2.79149e-1 * Y - 5.0764 * Z) * Z * Z;
			a8 = (1.37916e-1 - 6.72041e-2 * Z + 2.61987e-3 * Y) * Y * Y;
			a9 = exp(-3.433e1 - 1.823 * Y + 2.499e1 * Z + 6.503e-1 * Z * Y);
			F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
		}
		else if (Z < 2.50)
		{
			a1 = -1.65147e2 + 2.11028e2 * Z;
			a2 = (-4.70948 + 2.78258 * Z) * Y;
			a3 = (-8.78308e1 - 1.28571e-1 * Y + 1.27639e1 * Z) * Z * Z;
			a4 = (-3.19867e-1 + 1.76179e-1 * Z + 3.86106e-3 * Y) * Y * Y;
			a5 = 2.30407e2 - 2.98055e2 * Z;
			a6 = (-6.18307 + 8.44595 * Z) * Y;
			a7 = (1.26933e2 - 2.61671 * Y - 1.77257e1 * Z) * Z * Z;
			a8 = (-2.30229e-2 + 2.25458e-2 * Z - 4.41072e-3 * Y) * Y * Y;
			a9 = exp(-6.882e1 + 8.824 * Y + 3.203e1 * Z - 5.359 * Z * Y);
			F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
		}
		else if (Z < 2.85)
		{
			a1 = -7.09274e3 + 7.13648e3 * Z;
			a2 = (-2.46014e2 + 1.65826e2 * Z) * Y;
			a3 = (-2.37952e3 - 2.75487e1 * Y + 2.63465e2 * Z) * Z * Z;
			a4 = (-3.49744 + 1.28641 * Z - 3.13711e-3 * Y) * Y * Y;
			a5 = 5.26158e3 - 4.96701e3 * Z;
			a6 = (2.03138e2 - 1.32984e2 * Z) * Y;
			a7 = (1.52424e3 + 2.15081e1 * Y - 1.5045e2 * Z) * Z * Z;
			a8 = (3.32432 - 1.15997 * Z + 1.14862e-2 * Y) * Y * Y;
			a9 = exp(-3.594e2 - 3.763e1 * Y + 1.319e2 * Z + 1.348e1 * Z * Y);
			F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
		}
		else if (Z < 3.15)
		{
			a1 = -1.27748e3 + 1.294e3 * Z;
			a2 = (-3.60724e1 + 2.63194e1 * Z) * Y;
			a3 = (-4.22958e2 - 4.38228 * Y + 4.50571e1 * Z) * Z * Z;
			a4 = (-4.74425e-1 + 2.89684e-1 * Z + 1.64048e-2 * Y) * Y * Y;
			F = a1 + a2 + a3 + a4;
		}
		else if (Y < -3.80)
		{
			if (Z < 3.19)
			{
				a1 = 4.55919e3 - 4.21057e3 * Z;
				a2 = (1.03001e1 - 2.63478e1 * Z) * Y;
				a3 = (1.29069e3 + 6.59587 * Y - 1.31413e2 * Z) * Z * Z;
				a4 = (-8.28137 + 1.9827 * Z - 1.7287e-1 * Y) * Y * Y;
				F = a1 + a2 + a3 + a4;
			}
			else
			{
				Z = e / E_CURVE;
				a1 = -4.41792e2 + 9.7986e-2 * Z;
				a2 = (-3.03148e2 + 7.6065e-3 * Z) * Y;
				a3 = (-5.5711e-5 - 3.52836e-6 * Y + 8.86148e-9 * Z) * Z * Z;
				a4 = (-7.561e1 - 4.76816e-4 * Z - 6.48859 * Y) * Y * Y;
				a5 = 6.72387e4 + 3.2839 * Z;
				a6 = (3.55009e4 + 2.72616 * Z) * Y;
				a7 = (2.13714e-3 + 3.42377e-4 * Y - 6.84897e-8 * Z) * Z * Z;
				a8 = (6.50886e3 + 3.8056e-1 * Z + 4.14116e2 * Y) * Y * Y;
				a9 = exp(2.978e1 + 5.415 * Y + 1.713e-3 * Z + 3.115e-4 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 - a9);
			}
		}
		else
		{
			a1 = -6.4029e3 + 6.24254e3 * Z;
			a2 = (1.03279e2 - 8.73181e1 * Z) * Y;
			a3 = (-2.02865e3 + 1.71878e1 * Y + 2.19907e2 * Z) * Z * Z;
			a4 = (-1.22397e1 + 3.5783 * Z - 1.27953e-1 * Y) * Y * Y;
			F = a1 + a2 + a3 + a4;
		}

		return F;
	}

	double p(double e, double rho)
	{
		rho = rho * RHO0;
		e = e * E0 * KCAL_TO_M2_PS2;

		double Y = log10(rho / RHO_CURVE), Z = log10(e / E_CURVE);
		double F, a1, a2, a3, a4, a5, a6, a7, a8, a9;

		if (Z < 0.65)
		{
			return (rho * e * 0.3965) / ATM_TO_N_PM2 / P0;
		}
		else if (Y < -4.5)
		{
			if (Z < 1.50)
			{
				a1 = 1.52792 - 1.26953e-2 * Y;
				a2 = (-6.13514e-1 - 5.08262e-2 * Y) * Z;
				a3 = (-5.49384e-3 + 4.75120e-5 * Z - 3.18468e-4 * Y) * Y * Y;
				a4 = (6.31835e-1 + 3.34012e-2 * Y - 2.19921e-1 * Z) * Z * Z;
				a5 = -4.96286e1 - 1.17932e1 * Y;
				a6 = (6.91028e1 + 4.40405e1 * Y) * Z;
				a7 = (5.09249 - 1.40326 * Z + 2.08988e-1 * Y) * Y * Y;
				a8 = (1.37308e1 - 1.78726e1 * Y - 1.86943e1 * Z) * Z * Z;
				a9 = exp(24.60452 - 2.00 * Y - 2.093022e1 * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 - a9);
			}
			else if (Z < 2.20)
			{
				a1 = -1.70333e1 - 5.08545e-1 * Y;
				a2 = (2.46299e1 + 4.45617e-1 * Y) * Z;
				a3 = (-8.95298e-3 + 2.29618e-3 * Z - 2.89186e-4 * Y) * Y * Y;
				a4 = (-1.10204e1 - 9.89727e-2 * Y + 1.62903 * Z) * Z * Z;
				a5 = 1.86797e1 + 5.19662e-1 * Y;
				a6 = (-2.41338e1 - 4.34837e-1 * Y) * Z;
				a7 = (9.16089e-3 - 1.52082e-3 * Z + 3.46482e-4 * Y) * Y * Y;
				a8 = (1.02035e1 + 9.70762e-2 * Y - 1.3946 * Z) * Z * Z;
				a9 = exp(-1.42762e2 - 1.647088 * Y + 7.660312e1 * Z + 8.259346e-1 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
			else if (Z < 3.05)
			{
				a1 = 2.24374 + 1.03073e-1 * Y;
				a2 = (-5.32238e-1 - 5.59852e-2 * Y) * Z;
				a3 = (3.56484e-3 - 1.01359e-4 * Z + 1.59127e-4 * Y) * Y * Y;
				a4 = (-4.80156e-2 + 1.06794e-2 * Y + 3.66035e-2 * Z) * Z * Z;
				a5 = -5.70378 - 3.10056e-1 * Y;
				a6 = (5.01094 + 1.80411e-1 * Y) * Z;
				a7 = (-9.49361e-3 + 1.94839e-3 * Z - 2.24908e-4 * Y) * Y * Y;
				a8 = (-1.40331 - 2.79718e-2 * Y + 1.20278e-1 * Z) * Z * Z;
				a9 = exp(1.139755e2 - 4.985467 * Y - 4.223833e1 * Z + 2.009706 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
			else if (Z < 3.40)
			{
				a1 = -0.20807e2 + 0.40197 * Y;
				a2 = (0.22591e2 - 0.25660 * Y) * Z;
				a3 = (-0.95833e-3 + 0.23966e-2 * Z + 0.33671e-3 * Y) * Y * Y;
				a4 = (-0.77174e1 + .4606e-1 * Y + .878 * Z) * Z * Z;
				a5 = -0.21737e3 - 0.46927e1 * Y;
				a6 = (0.18101e3 + 0.26621e1 * Y) * Z;
				a7 = (-0.34759e-1 + 0.64681e-2 * Z - 0.70391e-3 * Y) * Y * Y;
				a8 = (-0.50019e2 - 0.38381 * Y + 0.45795e1 * Z) * Z * Z;
				a9 = exp(0.4544373e3 + 0.1250133e2 * Y - 0.1376001e3 * Z - 0.3641774e1 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
			else
			{
				a1 = -5.22951e1 - 4.00011e-1 * Y;
				a2 = (4.56439e1 + 2.2484e-1 * Y) * Z;
				a3 = (-3.73775e-3 + 2.43161e-3 * Z + 2.24955e-4 * Y) * Y * Y;
				a4 = (-1.29756e1 - 2.79517e-2 * Y + 1.22998 * Z) * Z * Z;
				F = a1 + a2 + a3 + a4;
			}
		}
		else if (Y < -0.5)
		{
			if (Z < 1.50)
			{
				a1 = 1.39123 - 4.08321e-3 * Y;
				a2 = (1.42545e-2 + 1.41769e-2 * Y) * Z;
				a3 = (2.57225e-4 + 6.52912e-4 * Z + 8.46912e-5 * Y) * Y * Y;
				a4 = (6.2555e-2 - 7.83637e-3 * Y - 9.78720e-2 * Z) * Z * Z;
				a5 = 5.80955 - 1.82302e-1 * Y;
				a6 = (-9.62396 + 1.79619e-1 * Y) * Z;
				a7 = (-2.30518e-2 + 1.1872e-2 * Z - 3.35499e-4 * Y) * Y * Y;
				a8 = (5.27047 - 3.65507e-2 * Y - 9.19897e-1 * Z) * Z * Z;
				a9 = exp(14.2 - 1.00e1 * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
			else if (Z < 2.22)
			{
				a1 = -1.20784 - 2.57909e-1 * Y;
				a2 = (5.02307 + 2.87201e-1 * Y) * Z;
				a3 = (-9.95577e-3 + 5.23524e-3 * Z - 1.45574e-4 * Y) * Y * Y;
				a4 = (-3.20619 - 7.50405e-2 * Y + 6.51564e-1 * Z) * Z * Z;
				a5 = -6.62841 + 2.77112e-2 * Y;
				a6 = (7.30762 - 7.6823e-2 * Y) * Z;
				a7 = (7.19421e-3 - 3.62463e-3 * Z + 1.62777e-4 * Y) * Y * Y;
				a8 = (-2.33161 + 3.04767e-2 * Y + 1.66856e-1 * Z) * Z * Z;
				a9 = exp(1.255324e2 + 2.015335 * Y - 6.390747e1 * Z - 6.515225e-1 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
			else if (Z < 2.95)
			{
				a1 = -2.2646 - 7.82263e-2 * Y;
				a2 = (4.90497 + 7.18096e-2 * Y) * Z;
				a3 = (-3.06443e-3 + 1.74209e-3 * Z + 2.84214e-5 * Y) * Y * Y;
				a4 = (-2.2475 - 1.31641e-2 * Y + 3.33658e-1 * Z) * Z * Z;
				a5 = -1.47904e1 - 1.76627e-1 * Y;
				a6 = (1.35036e1 + 8.77280e-2 * Y) * Z;
				a7 = (-2.13327e-3 + 7.15487e-4 * Z + 7.30928e-5 * Y) * Y * Y;
				a8 = (-3.95372 - 8.96151e-3 * Y + 3.63229e-1 * Z) * Z * Z;
				a9 = exp(1.788542e2 + 6.317894 * Y - 6.756741e1 * Z - 2.46006 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
			else
			{
				a1 = -1.66904e1 - 2.58318e-1 * Y;
				a2 = (1.7835e1 + 1.54898e-1 * Y) * Z;
				a3 = (-9.71263e-3 + 3.9774e-3 * Z + 9.04300e-5 * Y) * Y * Y;
				a4 = (-5.94108 - 2.01335e-2 * Y + 6.60432e-1 * Z) * Z * Z;
				a5 = 8.54690e1 + 1.17554e1 * Y;
				a6 = (-7.21760e1 - 7.15723 * Y) * Z;
				a7 = (-4.16150e-2 + 1.38147e-2 * Z + 5.45184e-4 * Y) * Y * Y;
				a8 = (2.01758e1 + 1.0899 * Y - 1.86438 * Z) * Z * Z;
				a9 = exp(2.883262e2 + 1.248536e1 * Y - 8.816985e1 * Z - 3.720309 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
		}
		else
		{
			if (Z < 1.70)
			{
				a1 = 1.37062 + 1.29673e-2 * Y;
				a2 = (1.11418e-1 - 3.26912e-2 * Y) * Z;
				a3 = (1.06869e-3 - 2.00286e-3 * Z + 2.38305e-4 * Y) * Y * Y;
				a4 = (-1.06133e-1 + 1.90251e-2 * Y + 3.0221e-3 * Z) * Z * Z;
				F = a1 + a2 + a3 + a4;
			}
			else if (Z < 2.35)
			{
				a1 = 3.43846e-2 - 2.33584e-1 * Y;
				a2 = (2.85574 + 2.59787e-1 * Y) * Z;
				a3 = (-10.89927e-3 + 4.23659e-3 * Z + 3.85712e-4 * Y) * Y * Y;
				a4 = (-1.94785 - 6.73865e-2 * Y + 4.08518e-1 * Z) * Z * Z;
				a5 = -4.20569 + 1.33139e-1 * Y;
				a6 = (4.51236 - 1.66341e-1 * Y) * Z;
				a7 = (1.67787e-3 - 1.10022e-3 * Z + 3.06676e-4 * Y) * Y * Y;
				a8 = (-1.35516 + 4.91716e-2 * Y + 7.52509e-2 * Z) * Z * Z;
				a9 = exp(1.757042e2 - 2.163278 * Y - 8.833702e1 * Z + 1.897543 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
			else
			{
				a1 = -1.70633 - 1.48403e-1 * Y;
				a2 = (4.23104 + 1.37290e-1 * Y) * Z;
				a3 = (-9.10934e-3 + 3.85707e-3 * Z + 2.69026e-4 * Y) * Y * Y;
				a4 = (-1.97292 - 2.8183e-2 * Y + 2.95882e-1 * Z) * Z * Z;
				a5 = 3.4158e1 - 1.89972e1 * Y;
				a6 = (-4.0858e1 + 1.30321e1 * Y) * Z;
				a7 = (-8.01272e-1 + 2.75121e-1 * Z - 1.77969e-4 * Y) * Y * Y;
				a8 = (1.60826e1 - 2.23386 * Y - 2.08853 * Z) * Z * Z;
				a9 = exp(2.561323e2 + 1.737089e2 * Y - 9.05889e1 * Z - 5.838803e1 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
		}

		return rho * e * (F - 1) / ATM_TO_N_PM2 / P0;
	}

	double T(double p, double rho)
	{
		rho = rho * RHO0;
		p = p * P0;

		double Y = log10(rho / RHO_CURVE), X = log10(p / P_CURVE), Z = X - Y;
		double F, a1, a2, a3, a4, a5, a6, a7, a8, a9;

		if (Z < 0.25)
		{
			return p / (rho * Rgas) / T0;
		}

		if (Y < -4.5)
		{
			if (Z < 0.95)
			{
				a1 = 1.23718e-1 + 1.08623e-2 * Y;
				a2 = (2.24239e-1 - 8.24608e-2 * Y) * Z;
				a3 = (-1.17615e-3 - 1.87566e-3 * Z - 1.19155e-4 * Y) * Y * Y;
				a4 = (1.18397 + 6.4852e-2 * Y - 5.52634e-1 * Z) * Z * Z;
				F = a1 + a2 + a3 + a4;
			}
			else if (Z < 1.40)
			{
				a1 = -8.12952 - 8.28637e-1 * Y;
				a2 = (2.26904e1 + 1.41132 * Y) * Z;
				a3 = (-2.98633e-2 + 2.70066e-2 * Z - 2.28103e-4 * Y) * Y * Y;
				a4 = (-1.91806e1 - 5.78875e-1 * Y + 5.62580 * Z) * Z * Z;
				a5 = -3.99845 + 2.26369e-1 * Y;
				a6 = (2.52870 - 7.28448e-1 * Y) * Z;
				a7 = (1.09769e-2 - 1.83819e-2 * Z - 1.5138e-4 * Y) * Y * Y;
				a8 = (2.99238 + 3.9144e-1 * Y - 2.04463 * Z) * Z * Z;
				a9 = exp(-3.887015e1 - 2.908228e1 * Y + 4.070557e1 * Z + 2.682347e1 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
			else if (Z < 1.95)
			{
				a1 = -1.98573e1 - 1.67225 * Y;
				a2 = (3.76159e1 + 2.10964 * Y) * Z;
				a3 = (-3.40174e-2 + 2.31712e-2 * Z - 9.80275e-5 * Y) * Y * Y;
				a4 = (-2.22215e1 - 6.44596e-1 * Y + 4.40486 * Z) * Z * Z;
				a5 = -5.36809 + 2.41201e-1 * Y;
				a6 = (-1.25881 - 8.62744e-1 * Y) * Z;
				a7 = (-3.79774e-3 - 7.81335e-3 * Z - 3.80005e-4 * Y) * Y * Y;
				a8 = (5.58609 + 3.78963e-1 * Y - 1.81566 * Z) * Z * Z;
				a9 = exp(2.08e1 - 2.56e1 * Y + 1.00 * Z + 1.8e1 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
			else
			{
				a1 = -2.33271e1 - 1.89958 * Y;
				a2 = (3.2144e1 + 1.68622 * Y) * Z;
				a3 = (-4.42123e-2 + 2.82629e-2 * Z + 6.63272e-4 * Y) * Y * Y;
				a4 = (-1.38645e1 - 3.40976e-1 * Y + 2.04466 * Z) * Z * Z;
				a5 = 8.35474 + 1.71347 * Y;
				a6 = (-1.60715e1 - 1.63139 * Y) * Z;
				a7 = (4.14641e-2 - 2.30068e-2 * Z + 1.53246e-5 * Y) * Y * Y;
				a8 = (8.70275 + 3.60966e-1 * Y - 1.46166 * Z) * Z * Z;
				a9 = exp(1.115884e2 - 6.452606 * Y - 5.337863e1 * Z + 2.026986 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
		}
		else if (Y < -0.5)
		{
			if (Z < 0.95)
			{
				a1 = 2.0391e-2 + 7.6731e-3 * Y;
				a2 = (8.48581e-1 - 2.93086e-2 * Y) * Z;
				a3 = (8.40269e-4 - 1.47701e-3 * Z + 3.13687e-5 * Y) * Y * Y;
				a4 = (2.67251e-1 + 2.37262e-2 * Y - 1.41973e-1 * Z) * Z * Z;
				F = a1 + a2 + a3 + a4;
			}
			else if (Z < 1.45)
			{
				a1 = -5.12404 - 2.8474e-1 * Y;
				a2 = (1.54532e1 + 4.52475e-1 * Y) * Z;
				a3 = (-1.22881e-2 + 8.56845e-3 * Z - 3.25256e-4 * Y) * Y * Y;
				a4 = (-1.35181e1 - 1.68725e-1 * Y + 4.18451 * Z) * Z * Z;
				a5 = 7.52564 + 8.35238e-1 * Y;
				a6 = (-1.95558e1 - 1.23393 * Y) * Z;
				a7 = (3.3451e-2 - 2.34269e-2 * Z + 4.81788e-4 * Y) * Y * Y;
				a8 = (1.71779e1 + 4.54628e-1 * Y - 5.09936 * Z) * Z * Z;
				a9 = exp(6.148442e1 - 1.828123e1 * Y - 5.468755e1 * Z + 1.562500e1 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
			else if (Z < 2.05)
			{
				a1 = -1.23779e1 - 1.14728 * Y;
				a2 = (2.41382e1 + 1.38957 * Y) * Z;
				a3 = (-3.63693e-2 + 2.24265e-2 * Z - 3.23888e-4 * Y) * Y * Y;
				a4 = (-1.42844e1 - 4.06553e-1 * Y + 2.8762 * Z) * Z * Z;
				a5 = 4.40782 + 1.33046 * Y;
				a6 = (-1.15405e1 - 1.59892 * Y) * Z;
				a7 = (5.3058e-2 - 3.10376e-2 * Z + 4.77650e-4 * Y) * Y * Y;
				a8 = (8.57309 + 4.71274e-1 * Y - 1.96233 * Z) * Z * Z;
				a9 = exp(1.4075e2 - 6.499992 * Y - 7.75e1 * Z + 5.00 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
			else
			{
				a1 = -1.27244e1 - 1.66684 * Y;
				a2 = (1.72708e1 + 1.45307 * Y) * Z;
				a3 = (-3.64515e-2 + 1.90463e-2 * Z + 4.80787e-4 * Y) * Y * Y;
				a4 = (-6.97208 - 3.04323e-1 * Y + 9.67524e-1 * Z) * Z * Z;
				a5 = 7.7133 + 5.0834e-1 * Y;
				a6 = (-9.8211 - 4.49138e-1 * Y) * Z;
				a7 = (-9.41787e-4 - 2.40293e-3 * Z - 8.28450e-4 * Y) * Y * Y;
				a8 = (4.16530 + 9.63923e-2 * Y - 5.88807e-1 * Z) * Z * Z;
				a9 = exp(-1.092654e3 - 3.05312e2 * Y + 4.656243e2 * Z + 1.312498e2 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
		}
		else
		{
			if (Z < 1.00)
			{
				a1 = -1.54141e-3 + 6.58337e-4 * Y;
				a2 = (9.82201e-1 - 3.85028e-3 * Y) * Z;
				a3 = (1.23111e-4 - 4.08210e-4 * Z + 2.13592e-5 * Y) * Y * Y;
				a4 = (3.77441e-2 + 4.56963e-3 * Y - 2.35172e-2 * Z) * Z * Z;
				F = a1 + a2 + a3 + a4;
			}
			else if (Z < 1.45)
			{
				a1 = 8.06492e-1 + 9.91293e-2 * Y;
				a2 = (-1.70742 - 2.28264e-1 * Y) * Z;
				a3 = (5.03500e-3 - 6.13927e-3 * Z + 1.69824e-4 * Y) * Y * Y;
				a4 = (3.02351 + 1.31574e-1 * Y - 1.12755 * Z) * Z * Z;
				a5 = -1.1793e-1 - 2.12207e-1 * Y;
				a6 = (1.36524 + 4.05886e-1 * Y) * Z;
				a7 = (-1.88260e-2 + 1.65486e-2 * Z - 5.114e-4 * Y) * Y * Y;
				a8 = (-2.10926 - 1.89881e-1 * Y + 8.79806e-1 * Z) * Z * Z;
				a9 = exp(1.959604e2 - 4.269391e1 * Y - 1.734931e2 * Z + 3.762898e1 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
			else
			{
				a1 = -1.66249 - 8.91113e-2 * Y;
				a2 = (4.11648 + 8.78093e-2 * Y) * Z;
				a3 = (-3.09742e-3 + 1.99879e-3 * Z + 6.85472e-5 * Y) * Y * Y;
				a4 = (-1.84445 - 7.50324e-3 * Y + 3.05784e-1 * Z) * Z * Z;
				a5 = 1.11555e1 + 1.3210 * Y;
				a6 = (-1.71236e1 - 1.2919 * Y) * Z;
				a7 = (6.28124e-2 - 3.07949e-2 * Z + 1.57743e-3 * Y) * Y * Y;
				a8 = (8.63804 + 3.07809e-1 * Y - 1.42634 * Z) * Z * Z;
				a9 = exp(1.330611e2 + 8.979635e1 * Y - 7.265298e1 * Z - 2.449009 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);
			}
		}

		return pow(10, F);
	}

	double k(double e, double rho)
	{
		rho = rho * RHO0;
		e = e * E0 * KCAL_TO_M2_PS2;

		double Y = log10(rho / RHO_CURVE), Z = log10(e / E_CURVE);
		double F, a1, a2, a3, a4, a5, a6, a7, a8, a9;

		if (Z < 0.44e00)
		{
			double T = 0.4e00 * e / 287.06e00;
			return 1.994e-03 * sqrt(T) / (1.0e00 + 112.0e00 / T) / K0;
		}

		if (Z < 0.65e00)
		{
			a1 = 1.8100369e-01 + 4.8126802e00 * Z;
			a2 = (-2.7231116e-02 + 1.2691337e-01 * Z) * Y;
			a3 = (-8.9913034e00 - 1.2624085e-01 * Y + 8.9649105e00 * Z) * Z * Z;
			a4 = (-4.7198236e-03 + 9.2328079e-03 * Z - 2.9485327e-04 * Y) * Y * Y;
			F = a1 + a2 + a3 + a4;
		}
		else if (Y < -1.0)
		{
			if (Y < -3.00e0)
			{
				if (Z < 1.25e00)
				{
					a1 = -1.05935e04 + 2.31470e4 * Z;
					a2 = (-7.41294e02 + 1.21724e3 * Z) * Y;
					a3 = (-1.67601e04 - 4.43184e2 * Y + 4.06631e3 * Z) * Z *Z;
					a4 = (1.35105e01 + 4.94914 * Z + 1.55386 * Y) * Y * Y;
					a5 = 1.06032e04 - 2.3156e4 * Z;
					a6 = (7.46951e02 - 1.22465e3 * Z) * Y;
					a7 = (1.67604e04 + 4.45919e2 * Y - 4.06258e3 * Z) * Z * Z;
					a8 = (-1.28615e1 - 5.32398 * Z - 1.52956 * Y) * Y * Y;
					a9 = exp(-4.219e01 - 4.687e00 * Y + 2.812e01 * Z + 3.125e00 * Y*Z);
					F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 - a9);
				}
				else if (Z < 1.775e00)
				{
					a1 = 3.79375e03 - 7.40351e03 * Z;
					a2 = (3.29698e02 - 3.55916e02 * Z) * Y;
					a3 = (4.77122e03 + 1.00241e02 * Y - 1.00740e03 * Z) * Z * Z;
					a4 = (1.97061e01 - 8.42554e00 * Z + 4.80494e-01 * Y) * Y * Y;
					a5 = -4.53603e03 + 9.05605e03 * Z;
					a6 = (-4.95870e02 + 6.33563e02 * Z) * Y;
					a7 = (-5.95317e03 - 2.05442e02 * Y + 1.28945e03 * Z) * Z * Z;
					a8 = (-2.00087e01 + 1.18851e01 * Z - 1.71735e-01 * Y) * Y * Y;
					a9 = exp(-3.318e01 + 3.158e-01 * Y + 1.863e01 * Z - 1.035e00 * Y*Z);
					F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 + a9);
				}
				else if (Z < 1.93e00)
				{
					a1 = 2.06651875e05 - 3.165645e05 * Z;
					a2 = (-3.07322021e02 + 4.57036377e02 * Z) * Y;
					a3 = (1.61824937e05 - 1.55508453e02 * Y - 2.7603957e04 * Z) * Z * Z;
					a4 = (1.92260265e00 - 2.24788094e00 * Z - 3.06226015e-01 * Y) * Y * Y;
					a5 = -2.06564312e05 + 3.18191312e05 * Z;
					a6 = (2.17542285e03 - 2.46670776e03 * Z) * Y;
					a7 = (-1.63597062e05 + 7.16753174e02 * Y + 2.80926367e04 * Z) * Z * Z;
					a8 = (3.39526825e01 - 7.53846645e00 * Z + 1.91214371e00 * Y) * Y * Y;
					a9 = exp(-3.924e02 - 5.206e01 * Y + 2.054e02 * Z + 2.679e01 * Y * Z);
					F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 + a9);
				}
				else if (Z < 2.60e00)
				{
					a1 = 7.1572625e04 - 9.2471625e04 * Z;
					a2 = (1.9646323e03 - 2.0280527e03 * Z) * Y;
					a3 = (3.9446105e04 + 4.5673853e02 * Y - 5.5728672e03 * Z) * Z * Z;
					a4 = (-9.2131958e01 + 1.2724541e01 * Z - 5.0568476e00 * Y) * Y * Y;
					a5 = -3.2910781e04 + 4.2551211e04 * Z;
					a6 = (1.4566331e03 - 2.2653745e03 * Z) * Y;
					a7 = (-1.9476277e04 + 8.4370288e02 * Y + 3.2389702e03 * Z) * Z * Z;
					a8 = (-1.3324594e02 + 1.0591533e02 * Z + 5.8639469e00 * Y) * Y * Y;
					a9 = exp(4.917e01 + 2.415e01 * Y - 2.455e01 * Z - 1.181e01 * Y*Z);
					F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 + a9);
				}
				else if (Z < 2.69e00)
				{
					a1 = 1.145683e06 - 1.237525e06 * Z;
					a2 = (1.4024508e04 - 9.3467227e03 * Z) * Y;
					a3 = (4.4593056e05 + 1.533074e03 * Y - 5.3608352e04 * Z) * Z * Z;
					a4 = (2.8485107e02 - 1.0968916e02 * Z - 1.0955791e00 * Y) * Y * Y;
					a5 = -1.752087e06 + 1.79675e06 * Z;
					a6 = (-1.3278737e05 + 9.8215562e04 * Z)* Y;
					a7 = (-6.0791744e05 - 1.811943e04 * Y + 6.7709875e04 * Z) * Z * Z;
					a8 = (-1.3384084e03 + 5.2707324e02 * Z + 2.5904894e00 * Y) * Y * Y;
					a9 = exp(-1.798e02 + 7.371e00 * Y + 6.731e01 * Z - 3.205e00 * Y * Z);
					F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 + a9);
				}
				else
				{
					a1 = -8.5499625e04 + 1.1739656e05 * Z;
					a2 = (6.4563168e04 - 3.9551203e04 * Z) * Y;
					a3 = (-4.8170254e04 + 6.0816055e03 * Y + 6.2052031e03 * Z) * Z * Z;
					a4 = (2.3473167e-01 + 1.8871567e01 * Z + 4.0757723e00 * Y) * Y * Y;
					a5 = 5.8546883e04 - 9.4634875e04 * Z;
					a6 = (-6.6513812e04 + 4.0899945e04 * Z) * Y;
					a7 = (4.2127227e04 - 6.3717305e03 * Y - 5.7495195e03 * Z) * Z * Z;
					a8 = (-1.0260344e00 - 5.343277e01 * Z - 1.1017392e01 * Y) * Y * Y;
					a9 = exp(5.411e00 + 1.162e01 * Y - 1.082e00 * Z - 3.391e00 * Y*Z);
					F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 - a9);
				}
			}
			else if (Z < 1.29e00)
			{
				a1 = -1.22493e04 + 2.41071e04 * Z;
				a2 = (-1.61829e03 + 2.22535e03 * Z) * Y;
				a3 = (-1.59261e04 - 7.53213e02 * Y + 3.53376e03 * Z) * Z * Z;
				a4 = (1.98026e00 + 5.18483e00 * Z + 1.47851e00 * Y) * Y * Y;
				a5 = 1.22486e04 - 2.41023e04 * Z;
				a6 = (1.61810e03 - 2.22571e03 * Z) * Y;
				a7 = (1.59235e04 + 7.53746e02 * Y - 3.53168e03 * Z) * Z * Z;
				a8 = (-2.15482e00 - 5.05115e00 * Z - 1.48795e00 * Y) * Y * Y;
				a9 = exp(-3.111e01 - 4.444e00 * Y + 1.944e01 * Z + 2.778e00 * Y*Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 - a9);
			}
			else if (Z < 1.85e00)
			{
				a1 = 3.18060e03 - 6.69664e03 * Z;
				a2 = (4.33382e01 - 2.14649e02 * Z) * Y;
				a3 = (4.41377e03 + 9.41359e01 * Y - 9.29758e02 * Z) * Z * Z;
				a4 = (-3.62190e01 + 1.15538e01 * Z - 2.14621e00 * Y) * Y * Y;
				a5 = -5.98764e03 + 1.29243e04 * Z;
				a6 = (-2.72261e02 + 5.42378e02 * Z) * Y;
				a7 = (-9.03293e03 - 2.11787e02 * Y + 2.07831e03 * Z) * Z * Z;
				a8 = (2.74179e01 - 5.68578e00 * Z + 1.91217e00 * Y) * Y * Y;
				a9 = exp(-1.854e01 + 7.11e00 * Y + 1.068e01 * Z - 5.449e00 * Y*Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 + a9);
			}
			else if (Z < 2.0e00)
			{
				a1 = 5.14024e04 - 7.52733e04 * Z;
				a2 = (-3.30889e02 + 3.11550e02 * Z) * Y;
				a3 = (3.66539e04 - 7.41227e01 * Y - 5.93015e03 * Z) * Z * Z;
				a4 = (-4.84164e01 + 2.23133e01 * Z - 9.19118e-01 * Y) * Y * Y;
				a5 = -1.80898e05 + 2.82532e05 * Z;
				a6 = (-1.01053e03 + 9.75576e02 * Z) * Y;
				a7 = (-1.47220e05 - 2.33631e02 * Y + 2.55940e04 * Z) * Z * Z;
				a8 = (3.28681e00 - 1.76588e00 * Z - 1.54962e-01 * Y) * Y * Y;
				a9 = exp(-4.104e01 + 6.507e01 * Y + 2.083e01 * Z - 3.472e01 * Z*Y);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 + a9);
			}
			else if (Z < 2.58e00)
			{
				a1 = 5.1131824e04 - 6.664875e04 * Z;
				a2 = (2.02171e03 - 1.9306292e03 * Z) * Y;
				a3 = (2.8762395e04 + 4.3353467e02 * Y - 4.1064609e03 * Z) * Z * Z;
				a4 = (-8.4970047e01 + 1.7925919e01 * Z - 6.2576542e00 * Y) * Y * Y;
				a5 = -6.2768156e04 + 8.6015875e04 * Z;
				a6 = (-1.0002036e03 + 6.2537280e02 * Z) * Y;
				a7 = (-3.957827e04 - 3.8467377e01 * Y + 6.12953e03 * Z) * Z * Z;
				a8 = (-1.0591702e02 + 7.636142e01 * Z + 5.938859e00 * Y) * Y * Y;
				a9 = exp(-3.901e00 + 2.418e01 * Y + 1.374e00 * Z - 1.145e01 * Y*Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 + a9);
			}
			else if (Z < 2.73e00)
			{
				a1 = 1.0088046e06 - 1.086321e06 * Z;
				a2 = (1.3844801e04 - 9.7268516e03 * Z) * Y;
				a3 = (3.8985325e05 + 1.7091665e03 * Y - 4.6621066e04 * Z) * Z * Z;
				a4 = (1.4840726e02 - 5.2645004e01 * Z - 1.5477133e-01 * Y) * Y * Y;
				a5 = -1.073351e06 + 1.14571e06 * Z;
				a6 = (-1.9343957e04 + 1.3366211e04 * Z) * Y;
				a7 = (-4.0670987e05 - 2.2955198e03 * Y + 4.7999871e04 * Z) * Z * Z;
				a8 = (-4.1016724e02 + 1.4994148e02 * Z - 1.9779787e00 * Y) * Y * Y;
				a9 = exp(-1.026e02 + 6.302e01 * Y + 3.819e01 * Z - 2.431e01 * Y*Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 + a9);
			}
			else
			{
				a1 = -9.6638500e04 + 1.3206488e04 * Z;
				a2 = (-4.7458105e04 + 2.3596875e04 * Z) * Y;
				a3 = (1.8602773e04 - 2.306802e03 * Y - 4.0413552e03 * Z) * Z * Z;
				a4 = (-5.3564258e03 + 2.2433904e03 * Z + 2.5188145e02 * Y) * Y * Y;
				a5 = 1.0962581e05 - 2.990116e04 * Z;
				a6 = (4.7883496e04 - 2.3785383e04 * Z) * Y;
				a7 = (-1.1753969e04 + 2.2905522e03 * Y + 3.1304399e03 * Z) * Z * Z;
				a8 = (5.473418e03 - 2.3208018e03 * Z - 2.6570068e02 * Y) * Y * Y;
				a9 = exp(-3.107e01 + 1.082e01 * Y + 1.047e01 * Z - 3.047e00 * Y*Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 - a9);
			}
		}
		else if (Z < 1.40e00)
		{
			a1 = -1.58386e03 + 3.49223e03 * Z;
			a2 = (-8.39834e02 + 1.09565e03 * Z) * Y;
			a3 = (-2.56175e03 - 3.56197e02 * Y + 6.25145e02 * Z) * Z * Z;
			a4 = (-1.22407e01 + 7.65634e00 * Z + 2.58235e-01 * Y) * Y * Y;
			a5 = 1.58025e03 - 3.47664e03 * Z;
			a6 = (8.39588e02 - 1.09490e03 * Z) * Y;
			a7 = (2.54682e03 + 3.55674e02 * Y - 6.18504e02 * Z) * Z * Z;
			a8 = (1.20843e01 - 7.44857e00 * Z - 2.91202e-01 * Y) * Y * Y;
			a9 = exp(-2.171e01 - 4.342e00 * Y + 1.316e01 * Z + 2.632e00 * Y * Z);
			F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 - a9);
		}
		else if (Z < 1.91e00)
		{
			a1 = 7.89255e02 - 1.91743e03 * Z;
			a2 = (3.59227e02 - 4.44070e02 * Z) * Y;
			a3 = (1.39463e03 + 1.34083e02 * Y - 3.13446e02 * Z) * Z * Z;
			a4 = (1.90681e01 - 1.09285e01 * Z + 4.24933e-02 * Y) * Y * Y;
			a5 = -1.31401e03 + 3.13134e03 * Z;
			a6 = (-5.18755e02 + 6.80268e02 * Z) * Y;
			a7 = (-2.32493e03 - 2.21393e02 * Y + 5.52563e02 * Z) * Z * Z;
			a8 = (-3.32001e01 + 2.11819e01 * Z - 4.75163e-01 * Y) * Y * Y;
			a9 = exp(-5.025e01 - 8.412e00 * Y + 2.982e01 * Z + 3.509e00 * Y * Z);
			F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 + a9);
		}
		else if (Z < 2.05e00)
		{
			a1 = 3.58691e04 - 5.16852e04 * Z;
			a2 = (-6.30189e02 + 6.63314e02 * Z) * Y;
			a3 = (2.47471e04 - 1.73538e02 * Y - 3.93167e03 * Z) * Z * Z;
			a4 = (-4.23871e01 + 2.08048e01 * Z - 1.05512e00 * Y) * Y * Y;
			a5 = -1.10522e05 + 1.67591e05 * Z;
			a6 = (4.61877e03 - 4.94930e03 * Z) * Y;
			a7 = (-8.46558e04 + 1.32441e03 * Y + 1.42438e04 * Z) * Z * Z;
			a8 = (2.25065e01 - 1.10316e01 * Z + 9.62887e-01 * Y) * Y * Y;
			a9 = exp(-1.681e02 + 7.063e01 * Y + 8.75e01 * Z - 3.75e01 * Y * Z);
			F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 + a9);
		}
		else if (Z < 2.57e00)
		{
			a1 = 3.1899562e04 - 4.2186664e04 * Z;
			a2 = (2.3055603e03 - 1.9897017e03 * Z) * Y;
			a3 = (1.849998e04 + 4.2561816e02 * Y - 2.6808696e03 * Z) * Z * Z;
			a4 = (-1.6195114e01 + 5.8640623e00 * Z - 3.6172504e00 * Y) * Y * Y;
			a5 = -5.7594039e04 + 7.9328437e04 * Z;
			a6 = (-1.9275989e03 + 1.6730544e03 * Z) * Y;
			a7 = (-3.6473008e04 - 3.6100732e02 * Y + 5.597543e03 * Z) * Z * Z;
			a8 = (-7.920808e01 + 4.0542084e01 * Z + 2.1495867e00 * Y) * Y * Y;
			a9 = exp(-5.733e01 + 2.088e01 * Y + 2.592e01 * Z - 9.793e00 * Y * Z);
			F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 + a9);
		}
		else if (Z < 2.75e00)
		{
			a1 = 7.0838087e05 - 7.5619919e05 * Z;
			a2 = (3.9503091e03 - 2.7381802e03 * Z) * Y;
			a3 = (2.6888181e05 + 4.7728687e02 * Y - 3.183816e04 * Z) * Z * Z;
			a4 = (-1.2532251e02 + 4.7734787e01 * Z - 4.0148029e00 * Y) * Y * Y;
			a5 = -2.5216325e05 + 2.1727769e05 * Z;
			a6 = (9.2882383e03 - 7.780918e03 * Z) * Y;
			a7 = (-5.6539297e04 + 1.6120212e03 * Y + 3.9419248e03 * Z) * Z * Z;
			a8 = (1.8537296e02 - 7.1010757e01 * Z + 1.1307096e00 * Y) * Y * Y;
			a9 = exp(-1.786e02 + 2.18e-01 * Y + 6.714e01 * Z - 4.739e-01 * Y*Z);
			F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1.0 + a9);
		}
		else
		{
			a1 = 3.1855037e05 - 3.3041156e05 * Z;
			a2 = (2.2983352e04 - 1.6623461e04 * Z) * Y;
			a3 = (1.13848e05 + 3.0098223e03 * Y - 1.3020133e04 * Z) * Z * Z;
			a4 = (-1.8599039e02 + 6.9840683e01 * Z - 7.7371645e00 * Y) * Y * Y;
			F = a1 + a2 + a3 + a4;
		}

		return F;
	}

	double a(double e, double rho)
	{
		rho = rho * RHO0;
		e = e * E0 * KCAL_TO_M2_PS2;

		double Y = log10(rho / RHO_CURVE), Z = log10(e / E_CURVE);
		double F, U, V, a1, a2, a3, a4, a5, a6, a7, a8, a9;

		if (Z < 0.65)
		{
			F = 1.3965;
		}
		else if (Y < -4.5)
		{
			if (Z < 1.50)
			{
				a1 = 1.52792 - 1.26953e-2 * Y;
				a2 = (-6.13514e-1 - 5.08262e-2 * Y) * Z;
				a3 = (-5.49384e-3 + 4.75120e-5 * Z - 3.18468e-4 * Y) * Y * Y;
				a4 = (6.31835e-1 + 3.34012e-2 * Y - 2.19921e-1 * Z) * Z * Z;
				a5 = -4.96286e1 - 1.17932e1 * Y;
				a6 = (6.91028e1 + 4.40405e1 * Y) * Z;
				a7 = (5.09249 - 1.40326 * Z + 2.08988e-1 * Y) * Y * Y;
				a8 = (1.37308e1 - 1.78726e1 * Y - 1.86943e1 * Z) * Z * Z;
				a9 = exp(24.60452 - 2.00 * Y - 2.093022e1 * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 - a9);

				a1 = -1.26953e-2 + (-5.08262e-2 + 6.31835e-1 * Z) * Z;
				a2 = (-5.49384e-3 * 2 - 3.18468e-4 * 2 * Z + 3.34012e-2 * 3 * Y) * Y;
				a3 = -1.17932e1 + (+4.40405e1 + 2.08988e-1 * Y + 1.37308e1 * Z) * Z + (5.09249 * 2 - 1.78726e1 * 2 * Y) * Y;
				a4 = exp(24.60452 - 2.00 * Y - 2.093022e1 * Z  * Y * Z);
				a5 = -4.96286e1 - 1.17932e1 * Y + (6.91028e1 + 4.40405e1 * Y) * Z;
				a6 = (5.09249 + 2.08988e-1 * Z - 1.78726e1 * Y) * Y * Y;
				a7 = (-1.40326 + 1.37308e1 * Y - 1.86943e1 * Z) * Z * Z;
				a8 = -2.00  * Z;
				a9 = exp(24.60452 - 2.00 * Y - 2.093022e1 * Z  * Y * Z);
				U = a1 + a2 + a3 / (1 + a4) + (a5 + a6 + a7) * a8 * a9 / ((1 - a9) * (1 - a9));

				a1 = -6.13514e-1 + (+4.75120e-5 * 2 - 2.19921e-1 * Z) * Z;
				a2 = (-5.08262e-2 + 6.31835e-1 * Z - 3.18468e-4 * Y) * Y;
				a3 = +6.91028e1 + (-1.40326 * 2 + 1.37308e1 * 2 * Y - 1.86943e1 * 3 * Z) * Z + (+4.40405e1 * 2 + 2.08988e-1 * Y) * Y;
				a4 = exp(+24.60452 - 2.00 * Y - 2.093022e1 * Z  * Y * Z);
				a5 = -4.96286e1 - 1.17932e1 * Y + (+6.91028e1 + 4.40405e1 * Y) * Z;
				a6 = (+5.09249 + 2.08988e-1 * Z - 1.78726e1 * Y) * Y * Y;
				a7 = (-1.40326 + 1.37308e1 * Y - 1.86943e1 * Z) * Z * Z;
				a8 = -2.00  * Z;
				a9 = exp(+24.60452 - 2.00 * Y - 2.093022e1 * Z  * Y * Z);
				V = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));
			}
			else if (Z < 2.20)
			{
				a1 = -1.70333e1 - 5.08545e-1 * Y;
				a2 = (2.46299e1 + 4.45617e-1 * Y) * Z;
				a3 = (-8.95298e-3 + 2.29618e-3 * Z - 2.89186e-4 * Y) * Y * Y;
				a4 = (-1.10204e1 - 9.89727e-2 * Y + 1.62903 * Z) * Z * Z;
				a5 = 1.86797e1 + 5.19662e-1 * Y;
				a6 = (-2.41338e1 - 4.34837e-1 * Y) * Z;
				a7 = (9.16089e-3 - 1.52082e-3 * Z + 3.46482e-4 * Y) * Y * Y;
				a8 = (1.02035e1 + 9.70762e-2 * Y - 1.3946 * Z) * Z * Z;
				a9 = exp(-1.42762e2 - 1.647088 * Y + 7.660312e1 * Z + 8.259346e-1 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);

				a1 = -5.08545e-1 + (+4.45617e-1 - 1.10204e1 * Z) * Z;
				a2 = (-8.95298e-3 * 2 - 2.89186e-4 * 2 * Z - 9.89727e-2 * 3 * Y) * Y;
				a3 = +5.19662e-1 + (-4.34837e-1 + 3.46482e-4 * Y + 1.02035e1 * Z) * Z + (+9.16089e-3 * 2 + 9.70762e-2 * 2 * Y) * Y;
				a4 = exp(-1.42762e2 - 1.647088 * Y + 7.660312e1 * Z + 8.259346e-1 * Y * Z);
				a5 = +1.86797e1 + 5.19662e-1 * Y + (-2.41338e1 - 4.34837e-1 * Y) * Z;
				a6 = (+9.16089e-3 + 3.46482e-4 * Z + 9.70762e-2 * Y) * Y * Y;
				a7 = (-1.52082e-3 + 1.02035e1 * Y - 1.3946 * Z) * Z * Z;
				a8 = -1.647088 + 8.259346e-1 * Z;
				a9 = exp(-1.42762e2 - 1.647088 * Y + 7.660312e1 * Z + 8.259346e-1 * Y * Z);
				U = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));
			
				a1 = +2.46299e1 + (+2.29618e-3 * 2 + 1.62903 * Z) * Z;
				a2 = (+4.45617e-1 - 1.10204e1 * Z - 2.89186e-4 * Y) * Y;
				a3 = -2.41338e1 + (-1.52082e-3 * 2 + 1.02035e1 * 2 * Y - 1.3946 * 3 * Z) * Z + (-4.34837e-1 * 2 + 3.46482e-4 * Y) * Y;
				a4 = exp(-1.42762e2 - 1.647088 * Y + 7.660312e1 * Z + 8.259346e-1 * Y * Z);
				a5 = +1.86797e1 + 5.19662e-1 * Y + (-2.41338e1 - 4.34837e-1 * Y) * Z;
				a6 = (+9.16089e-3 + 3.46482e-4 * Z + 9.70762e-2 * Y) * Y * Y;
				a7 = (-1.52082e-3 + 1.02035e1 * Y - 1.3946 * Z) * Z * Z;
				a8 = -1.647088 + 8.259346e-1 * Z;
				a9 = exp(-1.42762e2 - 1.647088 * Y + 7.660312e1 * Z + 8.259346e-1 * Y * Z);
				V = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));
			}
			else if (Z < 3.05)
			{
				a1 = 2.24374 + 1.03073e-1 * Y;
				a2 = (-5.32238e-1 - 5.59852e-2 * Y) * Z;
				a3 = (3.56484e-3 - 1.01359e-4 * Z + 1.59127e-4 * Y) * Y * Y;
				a4 = (-4.80156e-2 + 1.06794e-2 * Y + 3.66035e-2 * Z) * Z * Z;
				a5 = -5.70378 - 3.10056e-1 * Y;
				a6 = (5.01094 + 1.80411e-1 * Y) * Z;
				a7 = (-9.49361e-3 + 1.94839e-3 * Z - 2.24908e-4 * Y) * Y * Y;
				a8 = (-1.40331 - 2.79718e-2 * Y + 1.20278e-1 * Z) * Z * Z;
				a9 = exp(1.139755e2 - 4.985467 * Y - 4.223833e1 * Z + 2.009706 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);

				a1 = +1.03073e-1 + (-5.59852e-2 - 4.80156e-2 * Z) * Z;
				a2 = (+3.56484e-3 * 2 + 1.59127e-4 * 2 * Z + 1.06794e-2 * 3 * Y) * Y;
				a3 = -3.10056e-1 + (+1.80411e-1 - 2.24908e-4 * Y - 1.40331 * Z) * Z + (-9.49361e-3 * 2 - 2.79718e-2 * 2 * Y) * Y;
				a4 = exp(+1.139755e2 - 4.985467 * Y - 4.223833e1 * Z + 2.009706 * Y * Z);
				a5 = -5.70378 - 3.10056e-1 * Y + (+5.01094 + 1.80411e-1 * Y) * Z;
				a6 = (-9.49361e-3 - 2.24908e-4 * Z - 2.79718e-2 * Y) * Y * Y;
				a7 = (+1.94839e-3 - 1.40331 * Y + 1.20278e-1 * Z) * Z * Z;
				a8 = -4.985467 + 2.009706 * Z;
				a9 = exp(+1.139755e2 - 4.985467 * Y - 4.223833e1 * Z + 2.009706 * Y * Z);
				U = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));

				a1 = -5.32238e-1 + (-1.01359e-4 * 2 + 3.66035e-2 * Z) * Z;
				a2 = (-5.59852e-2 - 4.80156e-2 * Z + 1.59127e-4 * Y) * Y;
				a3 = +5.01094 + (+1.94839e-3 * 2 - 1.40331 * 2 * Y + 1.20278e-1 * 3 * Z) * Z + (+1.80411e-1 * 2 - 2.24908e-4 * Y) * Y;
				a4 = exp(+1.139755e2 - 4.985467 * Y - 4.223833e1 * Z + 2.009706 * Y * Z);
				a5 = -5.70378 - 3.10056e-1 * Y + (+5.01094 + 1.80411e-1 * Y) * Z;
				a6 = (-9.49361e-3 - 2.24908e-4 * Z - 2.79718e-2 * Y) * Y * Y;
				a7 = (+1.94839e-3 - 1.40331 * Y + 1.20278e-1 * Z) * Z * Z;
				a8 = -4.985467 + 2.009706 * Z;
				a9 = exp(+1.139755e2 - 4.985467 * Y - 4.223833e1 * Z + 2.009706 * Y * Z);
				V = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));
			}
			else if (Z < 3.40)
			{
				a1 = -0.20807e2 + 0.40197 * Y;
				a2 = (0.22591e2 - 0.25660 * Y) * Z;
				a3 = (-0.95833e-3 + 0.23966e-2 * Z + 0.33671e-3 * Y) * Y * Y;
				a4 = (-0.77174e1 + .4606e-1 * Y + .878 * Z) * Z * Z;
				a5 = -0.21737e3 - 0.46927e1 * Y;
				a6 = (0.18101e3 + 0.26621e1 * Y) * Z;
				a7 = (-0.34759e-1 + 0.64681e-2 * Z - 0.70391e-3 * Y) * Y * Y;
				a8 = (-0.50019e2 - 0.38381 * Y + 0.45795e1 * Z) * Z * Z;
				a9 = exp(0.4544373e3 + 0.1250133e2 * Y - 0.1376001e3 * Z - 0.3641774e1 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);

				a1 = +0.40197 + (-0.25660 - 0.77174e1 * Z) * Z;
				a2 = (-0.95833e-3 * 2 + 0.33671e-3 * 2 * Z + .4606e-1 * 3 * Y) * Y;
				a3 = -0.46927e1 + (+0.26621e1 - 0.70391e-3 * Y - 0.50019e2 * Z) * Z + (-0.34759e-1 * 2 - 0.38381 * 2 * Y) * Y;
				a4 = exp(+0.4544373e3 + 0.1250133e2 * Y - 0.1376001e3 * Z - 0.3641774e1 * Y * Z);
				a5 = -0.21737e3 - 0.46927e1 * Y + (+0.18101e3 + 0.26621e1 * Y) * Z;
				a6 = (-0.34759e-1 - 0.70391e-3 * Z - 0.38381 * Y) * Y * Y;
				a7 = (+0.64681e-2 - 0.50019e2 * Y + 0.45795e1 * Z) * Z * Z;
				a8 = +0.1250133e2 - 0.3641774e1 * Z;
				a9 = exp(+0.4544373e3 + 0.1250133e2 * Y - 0.1376001e3 * Z - 0.3641774e1 * Y * Z);
				U = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));
				
				a1 = +0.22591e2 + (+0.23966e-2 * 2 + .878 * Z) * Z;
				a2 = (-0.25660 - 0.77174e1 * Z + 0.33671e-3 * Y) * Y;
				a3 = +0.18101e3 + (+0.64681e-2 * 2 - 0.50019e2 * 2 * Y + 0.45795e1 * 3 * Z) * Z + (+0.26621e1 * 2 - 0.70391e-3 * Y) * Y;
				a4 = exp(+0.4544373e3 + 0.1250133e2 * Y - 0.1376001e3 * Z - 0.3641774e1 * Y * Z);
				a5 = -0.21737e3 - 0.46927e1 * Y + (+0.18101e3 + 0.26621e1 * Y) * Z;
				a6 = (-0.34759e-1 - 0.70391e-3 * Z - 0.38381 * Y) * Y * Y;
				a7 = (+0.64681e-2 - 0.50019e2 * Y + 0.45795e1 * Z) * Z * Z;
				a8 = +0.1250133e2 - 0.3641774e1 * Z;
				a9 = exp(+0.4544373e3 + 0.1250133e2 * Y - 0.1376001e3 * Z - 0.3641774e1 * Y * Z);
				V = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));
			}
			else
			{
				a1 = -5.22951e1 - 4.00011e-1 * Y;
				a2 = (4.56439e1 + 2.2484e-1 * Y) * Z;
				a3 = (-3.73775e-3 + 2.43161e-3 * Z + 2.24955e-4 * Y) * Y * Y;
				a4 = (-1.29756e1 - 2.79517e-2 * Y + 1.22998 * Z) * Z * Z;
				F = a1 + a2 + a3 + a4;

				a1 = -4.00011e-1 + (+2.2484e-1 - 1.29756e1 * Z) * Z;
				a2 = (-3.73775e-3 * 2 + 2.24955e-4 * 2 * Z - 2.79517e-2 * 3 * Y) * Y;
				U = a1 + a2;

				a1 = +4.56439e1 + (+2.43161e-3 * 2 + 1.22998 * Z) * Z;
				a2 = (+2.2484e-1 - 1.29756e1 * Z + 2.24955e-4 * Y) * Y;
				V = a1 + a2;
			}
		}
		else if (Y < -0.5)
		{
			if (Z < 1.50)
			{
				a1 = 1.39123 - 4.08321e-3 * Y;
				a2 = (1.42545e-2 + 1.41769e-2 * Y) * Z;
				a3 = (2.57225e-4 + 6.52912e-4 * Z + 8.46912e-5 * Y) * Y * Y;
				a4 = (6.2555e-2 - 7.83637e-3 * Y - 9.78720e-2 * Z) * Z * Z;
				a5 = 5.80955 - 1.82302e-1 * Y;
				a6 = (-9.62396 + 1.79619e-1 * Y) * Z;
				a7 = (-2.30518e-2 + 1.1872e-2 * Z - 3.35499e-4 * Y) * Y * Y;
				a8 = (5.27047 - 3.65507e-2 * Y - 9.19897e-1 * Z) * Z * Z;
				a9 = exp(14.2 - 1.00e1 * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);

				a1 = -4.08321e-3 + (+1.41769e-2 + 6.2555e-2 * Z) * Z;
				a2 = (+2.57225e-4 * 2 + 8.46912e-5 * 2 * Z - 7.83637e-3 * 3 * Y) * Y;
				a3 = -1.82302e-1 + (+1.79619e-1 - 3.35499e-4 * Y + 5.27047 * Z) * Z + (-2.30518e-2 * 2 - 3.65507e-2 * 2 * Y) * Y;
				a4 = exp(+14.2  * Y - 1.00e1 * Z  * Y * Z);
				a5 = +5.80955 - 1.82302e-1 * Y + (-9.62396 + 1.79619e-1 * Y) * Z;
				a6 = (-2.30518e-2 - 3.35499e-4 * Z - 3.65507e-2 * Y) * Y * Y;
				a7 = (+1.1872e-2 + 5.27047 * Y - 9.19897e-1 * Z) * Z * Z;
				a8 = 0 *Z;
				a9 = exp(+14.2  * Y - 1.00e1 * Z  * Y * Z);
				U = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));

				a1 = +1.42545e-2 + (+6.52912e-4 * 2 - 9.78720e-2 * Z) * Z;
				a2 = (+1.41769e-2 + 6.2555e-2 * Z + 8.46912e-5 * Y) * Y;
				a3 = -9.62396 + (+1.1872e-2 * 2 + 5.27047 * 2 * Y - 9.19897e-1 * 3 * Z) * Z + (+1.79619e-1 * 2 - 3.35499e-4 * Y) * Y;
				a4 = exp(+14.2  * Y - 1.00e1 * Z  * Y * Z);
				a5 = +5.80955 - 1.82302e-1 * Y + (-9.62396 + 1.79619e-1 * Y) * Z;
				a6 = (-2.30518e-2 - 3.35499e-4 * Z - 3.65507e-2 * Y) * Y * Y;
				a7 = (+1.1872e-2 + 5.27047 * Y - 9.19897e-1 * Z) * Z * Z;
				a8 = 0*Z;
				a9 = exp(+14.2  * Y - 1.00e1 * Z  * Y * Z);
				V = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));
			}
			else if (Z < 2.22)
			{
				a1 = -1.20784 - 2.57909e-1 * Y;
				a2 = (5.02307 + 2.87201e-1 * Y) * Z;
				a3 = (-9.95577e-3 + 5.23524e-3 * Z - 1.45574e-4 * Y) * Y * Y;
				a4 = (-3.20619 - 7.50405e-2 * Y + 6.51564e-1 * Z) * Z * Z;
				a5 = -6.62841 + 2.77112e-2 * Y;
				a6 = (7.30762 - 7.6823e-2 * Y) * Z;
				a7 = (7.19421e-3 - 3.62463e-3 * Z + 1.62777e-4 * Y) * Y * Y;
				a8 = (-2.33161 + 3.04767e-2 * Y + 1.66856e-1 * Z) * Z * Z;
				a9 = exp(1.255324e2 + 2.015335 * Y - 6.390747e1 * Z - 6.515225e-1 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);

				a1 = -2.57909e-1 + (+2.87201e-1 - 3.20619 * Z) * Z;
				a2 = (-9.95577e-3 * 2 - 1.45574e-4 * 2 * Z - 7.50405e-2 * 3 * Y) * Y;
				a3 = +2.77112e-2 + (-7.6823e-2 + 1.62777e-4 * Y - 2.33161 * Z) * Z + (+7.19421e-3 * 2 + 3.04767e-2 * 2 * Y) * Y;
				a4 = exp(+1.255324e2 + 2.015335 * Y - 6.390747e1 * Z - 6.515225e-1 * Y * Z);
				a5 = -6.62841 + 2.77112e-2 * Y + (+7.30762 - 7.6823e-2 * Y) * Z;
				a6 = (+7.19421e-3 + 1.62777e-4 * Z + 3.04767e-2 * Y) * Y * Y;
				a7 = (-3.62463e-3 - 2.33161 * Y + 1.66856e-1 * Z) * Z * Z;
				a8 = +2.015335 - 6.515225e-1 * Z;
				a9 = exp(+1.255324e2 + 2.015335 * Y - 6.390747e1 * Z - 6.515225e-1 * Y * Z);
				U = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));

				a1 = +5.02307 + (+5.23524e-3 * 2 + 6.51564e-1 * Z) * Z;
				a2 = (+2.87201e-1 - 3.20619 * Z - 1.45574e-4 * Y) * Y;
				a3 = +7.30762 + (-3.62463e-3 * 2 - 2.33161 * 2 * Y + 1.66856e-1 * 3 * Z) * Z + (-7.6823e-2 * 2 + 1.62777e-4 * Y) * Y;
				a4 = exp(+1.255324e2 + 2.015335 * Y - 6.390747e1 * Z - 6.515225e-1 * Y * Z);
				a5 = -6.62841 + 2.77112e-2 * Y + (+7.30762 - 7.6823e-2 * Y) * Z;
				a6 = (+7.19421e-3 + 1.62777e-4 * Z + 3.04767e-2 * Y) * Y * Y;
				a7 = (-3.62463e-3 - 2.33161 * Y + 1.66856e-1 * Z) * Z * Z;
				a8 = +2.015335 - 6.515225e-1 * Z;
				a9 = exp(+1.255324e2 + 2.015335 * Y - 6.390747e1 * Z - 6.515225e-1 * Y * Z);
				V = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));
			}
			else if (Z < 2.95)
			{
				a1 = -2.2646 - 7.82263e-2 * Y;
				a2 = (4.90497 + 7.18096e-2 * Y) * Z;
				a3 = (-3.06443e-3 + 1.74209e-3 * Z + 2.84214e-5 * Y) * Y * Y;
				a4 = (-2.2475 - 1.31641e-2 * Y + 3.33658e-1 * Z) * Z * Z;
				a5 = -1.47904e1 - 1.76627e-1 * Y;
				a6 = (1.35036e1 + 8.77280e-2 * Y) * Z;
				a7 = (-2.13327e-3 + 7.15487e-4 * Z + 7.30928e-5 * Y) * Y * Y;
				a8 = (-3.95372 - 8.96151e-3 * Y + 3.63229e-1 * Z) * Z * Z;
				a9 = exp(1.788542e2 + 6.317894 * Y - 6.756741e1 * Z - 2.46006 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);

				a1 = -7.82263e-2 + (+7.18096e-2 - 2.2475 * Z) * Z;
				a2 = (-3.06443e-3 * 2 + 2.84214e-5 * 2 * Z - 1.31641e-2 * 3 * Y) * Y;
				a3 = -1.76627e-1 + (+8.77280e-2 + 7.30928e-5 * Y - 3.95372 * Z) * Z + (-2.13327e-3 * 2 - 8.96151e-3 * 2 * Y) * Y;
				a4 = exp(+1.788542e2 + 6.317894 * Y - 6.756741e1 * Z - 2.46006 * Y * Z);
				a5 = -1.47904e1 - 1.76627e-1 * Y + (+1.35036e1 + 8.77280e-2 * Y) * Z;
				a6 = (-2.13327e-3 + 7.30928e-5 * Z - 8.96151e-3 * Y) * Y * Y;
				a7 = (+7.15487e-4 - 3.95372 * Y + 3.63229e-1 * Z) * Z * Z;
				a8 = +6.317894 - 2.46006 * Z;
				a9 = exp(+1.788542e2 + 6.317894 * Y - 6.756741e1 * Z - 2.46006 * Y * Z);
				U = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));

				a1 = +4.90497 + (+1.74209e-3 * 2 + 3.33658e-1 * Z) * Z;
				a2 = (+7.18096e-2 - 2.2475 * Z + 2.84214e-5 * Y) * Y;
				a3 = +1.35036e1 + (+7.15487e-4 * 2 - 3.95372 * 2 * Y + 3.63229e-1 * 3 * Z) * Z + (+8.77280e-2 * 2 + 7.30928e-5 * Y) * Y;
				a4 = exp(+1.788542e2 + 6.317894 * Y - 6.756741e1 * Z - 2.46006 * Y * Z);
				a5 = -1.47904e1 - 1.76627e-1 * Y + (+1.35036e1 + 8.77280e-2 * Y) * Z;
				a6 = (-2.13327e-3 + 7.30928e-5 * Z - 8.96151e-3 * Y) * Y * Y;
				a7 = (+7.15487e-4 - 3.95372 * Y + 3.63229e-1 * Z) * Z * Z;
				a8 = +6.317894 - 2.46006 * Z;
				a9 = exp(+1.788542e2 + 6.317894 * Y - 6.756741e1 * Z - 2.46006 * Y * Z);
				V = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));
			}
			else
			{
				a1 = -1.66904e1 - 2.58318e-1 * Y;
				a2 = (1.7835e1 + 1.54898e-1 * Y) * Z;
				a3 = (-9.71263e-3 + 3.9774e-3 * Z + 9.04300e-5 * Y) * Y * Y;
				a4 = (-5.94108 - 2.01335e-2 * Y + 6.60432e-1 * Z) * Z * Z;
				a5 = 8.54690e1 + 1.17554e1 * Y;
				a6 = (-7.21760e1 - 7.15723 * Y) * Z;
				a7 = (-4.16150e-2 + 1.38147e-2 * Z + 5.45184e-4 * Y) * Y * Y;
				a8 = (2.01758e1 + 1.0899 * Y - 1.86438 * Z) * Z * Z;
				a9 = exp(2.883262e2 + 1.248536e1 * Y - 8.816985e1 * Z - 3.720309 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);

				a1 = -2.58318e-1 + (+1.54898e-1 - 5.94108 * Z) * Z;
				a2 = (-9.71263e-3 * 2 + 9.04300e-5 * 2 * Z - 2.01335e-2 * 3 * Y) * Y;
				a3 = +1.17554e1 + (-7.15723 + 5.45184e-4 * Y + 2.01758e1 * Z) * Z + (-4.16150e-2 * 2 + 1.0899 * 2 * Y) * Y;
				a4 = exp(+2.883262e2 + 1.248536e1 * Y - 8.816985e1 * Z - 3.720309 * Y * Z);
				a5 = +8.54690e1 + 1.17554e1 * Y + (-7.21760e1 - 7.15723 * Y) * Z;
				a6 = (-4.16150e-2 + 5.45184e-4 * Z + 1.0899 * Y) * Y * Y;
				a7 = (+1.38147e-2 + 2.01758e1 * Y - 1.86438 * Z) * Z * Z;
				a8 = +1.248536e1 - 3.720309 * Z;
				a9 = exp(+2.883262e2 + 1.248536e1 * Y - 8.816985e1 * Z - 3.720309 * Y * Z);
				U = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));

				a1 = +1.7835e1 + (+3.9774e-3 * 2 + 6.60432e-1 * Z) * Z;
				a2 = (+1.54898e-1 - 5.94108 * Z + 9.04300e-5 * Y) * Y;
				a3 = -7.21760e1 + (+1.38147e-2 * 2 + 2.01758e1 * 2 * Y - 1.86438 * 3 * Z) * Z + (-7.15723 * 2 + 5.45184e-4 * Y) * Y;
				a4 = exp(+2.883262e2 + 1.248536e1 * Y - 8.816985e1 * Z - 3.720309 * Y * Z);
				a5 = +8.54690e1 + 1.17554e1 * Y + (-7.21760e1 - 7.15723 * Y) * Z;
				a6 = (-4.16150e-2 + 5.45184e-4 * Z + 1.0899 * Y) * Y * Y;
				a7 = (+1.38147e-2 + 2.01758e1 * Y - 1.86438 * Z) * Z * Z;
				a8 = +1.248536e1 - 3.720309 * Z;
				a9 = exp(+2.883262e2 + 1.248536e1 * Y - 8.816985e1 * Z - 3.720309 * Y * Z);
				V = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));
			}
		}
		else
		{
			if (Z < 1.70)
			{
				a1 = 1.37062 + 1.29673e-2 * Y;
				a2 = (1.11418e-1 - 3.26912e-2 * Y) * Z;
				a3 = (1.06869e-3 - 2.00286e-3 * Z + 2.38305e-4 * Y) * Y * Y;
				a4 = (-1.06133e-1 + 1.90251e-2 * Y + 3.0221e-3 * Z) * Z * Z;
				F = a1 + a2 + a3 + a4;

				a1 = +1.29673e-2 + (-3.26912e-2 - 1.06133e-1 * Z) * Z;
				a2 = (+1.06869e-3 * 2 + 2.38305e-4 * 2 * Z + 1.90251e-2 * 3 * Y) * Y;
				U = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));
			
				a1 = +1.11418e-1 + (-2.00286e-3 * 2 + 3.0221e-3 * Z) * Z;
				a2 = (-3.26912e-2 - 1.06133e-1 * Z + 2.38305e-4 * Y) * Y;
				V = a1 + a2;
			}
			else if (Z < 2.35)
			{
				a1 = 3.43846e-2 - 2.33584e-1 * Y;
				a2 = (2.85574 + 2.59787e-1 * Y) * Z;
				a3 = (-10.89927e-3 + 4.23659e-3 * Z + 3.85712e-4 * Y) * Y * Y;
				a4 = (-1.94785 - 6.73865e-2 * Y + 4.08518e-1 * Z) * Z * Z;
				a5 = -4.20569 + 1.33139e-1 * Y;
				a6 = (4.51236 - 1.66341e-1 * Y) * Z;
				a7 = (1.67787e-3 - 1.10022e-3 * Z + 3.06676e-4 * Y) * Y * Y;
				a8 = (-1.35516 + 4.91716e-2 * Y + 7.52509e-2 * Z) * Z * Z;
				a9 = exp(1.757042e2 - 2.163278 * Y - 8.833702e1 * Z + 1.897543 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);

				a1 = -2.33584e-1 + (+2.59787e-1 - 1.94785 * Z) * Z;
				a2 = (-10.89927e-3 * 2 + 3.85712e-4 * 2 * Z - 6.73865e-2 * 3 * Y) * Y;
				a3 = +1.33139e-1 + (-1.66341e-1 + 3.06676e-4 * Y - 1.35516 * Z) * Z + (+1.67787e-3 * 2 + 4.91716e-2 * 2 * Y) * Y;
				a4 = exp(+1.757042e2 - 2.163278 * Y - 8.833702e1 * Z + 1.897543 * Y * Z);
				a5 = -4.20569 + 1.33139e-1 * Y + (+4.51236 - 1.66341e-1 * Y) * Z;
				a6 = (+1.67787e-3 + 3.06676e-4 * Z + 4.91716e-2 * Y) * Y * Y;
				a7 = (-1.10022e-3 - 1.35516 * Y + 7.52509e-2 * Z) * Z * Z;
				a8 = -2.163278 + 1.897543 * Z;
				a9 = exp(+1.757042e2 - 2.163278 * Y - 8.833702e1 * Z + 1.897543 * Y * Z);
				U = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));

				a1 = +2.85574 + (+4.23659e-3 * 2 + 4.08518e-1 * Z) * Z;
				a2 = (+2.59787e-1 - 1.94785 * Z + 3.85712e-4 * Y) * Y;
				a3 = +4.51236 + (-1.10022e-3 * 2 - 1.35516 * 2 * Y + 7.52509e-2 * 3 * Z) * Z + (-1.66341e-1 * 2 + 3.06676e-4 * Y) * Y;
				a4 = exp(+1.757042e2 - 2.163278 * Y - 8.833702e1 * Z + 1.897543 * Y * Z);
				a5 = -4.20569 + 1.33139e-1 * Y + (+4.51236 - 1.66341e-1 * Y) * Z;
				a6 = (+1.67787e-3 + 3.06676e-4 * Z + 4.91716e-2 * Y) * Y * Y;
				a7 = (-1.10022e-3 - 1.35516 * Y + 7.52509e-2 * Z) * Z * Z;
				a8 = -2.163278 + 1.897543 * Z;
				a9 = exp(+1.757042e2 - 2.163278 * Y - 8.833702e1 * Z + 1.897543 * Y * Z);
				V = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));
			}
			else
			{
				a1 = -1.70633 - 1.48403e-1 * Y;
				a2 = (4.23104 + 1.37290e-1 * Y) * Z;
				a3 = (-9.10934e-3 + 3.85707e-3 * Z + 2.69026e-4 * Y) * Y * Y;
				a4 = (-1.97292 - 2.8183e-2 * Y + 2.95882e-1 * Z) * Z * Z;
				a5 = 3.4158e1 - 1.89972e1 * Y;
				a6 = (-4.0858e1 + 1.30321e1 * Y) * Z;
				a7 = (-8.01272e-1 + 2.75121e-1 * Z - 1.77969e-4 * Y) * Y * Y;
				a8 = (1.60826e1 - 2.23386 * Y - 2.08853 * Z) * Z * Z;
				a9 = exp(2.561323e2 + 1.737089e2 * Y - 9.05889e1 * Z - 5.838803e1 * Y * Z);
				F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 + a9);

				a1 = -1.48403e-1 + (+1.37290e-1 - 1.97292 * Z) * Z;
				a2 = (-9.10934e-3 * 2 + 2.69026e-4 * 2 * Z - 2.8183e-2 * 3 * Y) * Y;
				a3 = -1.89972e1 + (+1.30321e1 - 1.77969e-4 * Y + 1.60826e1 * Z) * Z + (-8.01272e-1 * 2 - 2.23386 * 2 * Y) * Y;
				a4 = exp(+2.561323e2 + 1.737089e2 * Y - 9.05889e1 * Z - 5.838803e1 * Y * Z);
				a5 = +3.4158e1 - 1.89972e1 * Y + (-4.0858e1 + 1.30321e1 * Y) * Z;
				a6 = (-8.01272e-1 - 1.77969e-4 * Z - 2.23386 * Y) * Y * Y;
				a7 = (+2.75121e-1 + 1.60826e1 * Y - 2.08853 * Z) * Z * Z;
				a8 = +1.737089e2 - 5.838803e1 * Z;
				a9 = exp(+2.561323e2 + 1.737089e2 * Y - 9.05889e1 * Z - 5.838803e1 * Y * Z);
				U = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));

				a1 = +4.23104 + (+3.85707e-3 * 2 + 2.95882e-1 * Z) * Z;
				a2 = (+1.37290e-1 - 1.97292 * Z + 2.69026e-4 * Y) * Y;
				a3 = -4.0858e1 + (+2.75121e-1 * 2 + 1.60826e1 * 2 * Y - 2.08853 * 3 * Z) * Z + (+1.30321e1 * 2 - 1.77969e-4 * Y) * Y;
				a4 = exp(+2.561323e2 + 1.737089e2 * Y - 9.05889e1 * Z - 5.838803e1 * Y * Z);
				a5 = +3.4158e1 - 1.89972e1 * Y + (-4.0858e1 + 1.30321e1 * Y) * Z;
				a6 = (-8.01272e-1 - 1.77969e-4 * Z - 2.23386 * Y) * Y * Y;
				a7 = (+2.75121e-1 + 1.60826e1 * Y - 2.08853 * Z) * Z * Z;
				a8 = +1.737089e2 - 5.838803e1 * Z;
				a9 = exp(+2.561323e2 + 1.737089e2 * Y - 9.05889e1 * Z - 5.838803e1 * Y * Z);
				V = a1 + a2 + a3 / (1 + a4) - (a5 + a6 + a7) * a8 * a9 / ((1 + a9) * (1 + a9));
			}
		}

		return sqrt(e * ((F - 1) * (F + U) + V));
	}
}
