
#include "curve.h"

namespace FIT
{
	double mu(double e, double rho)
	{
		double Y = log10(rho / RHO0), Z = log10(e / E0);
		double F, a1, a2, a3, a4, a5, a6, a7, a8, a9;

		if (Y < -5 || Y > 1)
		{
			rho = 6;
			e = 1000;
		}

		if (Z < 0.44)
		{
			double T = 0.4 * e / 287.06;
			return 1.462e-6 * sqrt(T) / (1 + 112 / T);
		}
		
		if (Z < 0.67)
		{
			a1 = 4.84547e-1 + 4.67135e-1 * Z;
			a2 = (5.71205e-4 - 1.43629e-3 * Z) * Y;
			a3 = (2.5511 - 2.33472e-4 * Y - 1.44102 * Z) * Z * Z;
			a4 = (2.53416e-4 - 4.72375e-4 * Z + 1.86899e-5 * Y) * Y * Y;
			F = a1 + a2 + a3 + a4;
		}
		else if (Z < 1.75)
		{
			a1 = -3.71666e1 + 6.67883e1 * Z;
			a2 = (-2.43998 + 2.12309 * Z) * Y;
			a3 = (-3.69259e1 - 3.08426e-1 * Y + 7.36486 * Z) * Z * Z;
			a4 = (-1.46446e-1 + 7.54423e-2 * Z - 2.91464e-3 * Y) * Y * Y;
			a5 = 3.61757e1 - 6.11102e1 * Z;
			a6 = (2.40531 - 2.05914 * Z) * Y;
			a7 = (3.23911e1 + 2.79149e-1 * Y - 5.0764 * Z) * Z * Z;
			a8 = (1.37916e-1 - 6.72041e-2 * Z _ 2.61987e-3 * Y) * Y * Y;
			a9 = exp(-3.433e1 - 1.823 * Y + 2.499e1 * Z + 6.503e-1 * Z * Y);
			F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 - a9);
		}
		else if (Z < 2.50)
		{
			a1 = -1.65147e2 + 2.11028e2 * Z;
			a2 = (-4.70948 + 2.78258 * Z) * Y;
			a3 = (-8.78308e1 - 1.28571e-1 * Y + 1.27639e1 * Z) * Z * Z;
			a4 = (-3.19867e-1 + 1.76179e-1 * Z + 3.86106e-3 * Y) * Y * Y;
			a5 = 2.30407e2 - 2.98055e2 * Z;
			a6 = (-6.18307 + 8.44595 * Z) * Y;
			a7 = (1.26933e2 - 2.61671 * Y - 1.27257e1 * Z) * Z * Z;
			a8 = (-2.30229e-2 + 2.25458e-2 * Z - 4.41072e-3 * Y) * Y * Y;
			a9 = exp(-6.882e1 + 8.824 * Y + 3.203e1 * Z - 5.359 * Z * Y);
			F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 - a9);
		}
		else if (Z < 2.85)
		{
			a1 = -7.09274e3 + 7.13648e3 * Z;
			a2 = (-2.46014e2 + 1.65826e2 * Z) * Y;
			a3 = (-2.37952e3 - 2.75487e1 * Y + 2.63465e2 * Z) * Z * Z;
			a4 = (-3.49744 + 1.28641 * Z - 3.13711e-3 * Y) * Y * Y;
			a5 = 5.26158e3 - 4.96701e3 * Z;
			a6 = (2.03138e2 - 1.32984e2 * Z) * Y;
			a7 = (1.52424e3 + 2.15081e1 * Y - 1.5045e2 * Z) * Z * Z;
			a8 = (3.32432 - 1.15997 * Z + 1.14862e-2 * Y) * Y * Y;
			a9 = exp(-3.594e2 - 3.763e1 * Y + 1.319e2 * Z + 1.348e1 * Z * Y);
			F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 - a9);
		}
		else if (Z < 3.15)
		{
			a1 = -1.27748e3 + 1.294e3 * Z;
			a2 = (-3.60724e1 + 2.63194e1 * Z) * Y;
			a3 = (-4.22958e2 - 4.38228 * Y + 4.50571e1 * Z) * Z * Z;
			a4 = (-4.74425e-1 + 2.89684e-1 * Z + 1.64048e-2 * Y) * Y * Y;
			F = a1 + a2 + a3 + a4;
		}
		else if (Y < -3.80)
		{
			if (Z < 3.19)
			{
				a1 = 4.55919e3 - 3.21057e3 * Z;
				a2 = (1.03001e1 - 2.63478e1 * Z) * Y;
				a3 = (1.29069e3 + 6.59587 * Y - 1.31413e2 * Z) * Z * Z;
				a4 = (-8.28137 + 1.9827 * Z - 1.7287e-1 * Y) * Y * Y;
				F = a1 + a2 + a3 + a4;
			}

			Z = e / E0;
			a1 = 4.55919e3 - 4.21057e3 * Z;
			a2 = (-3.03148e2 + 7.6065e-3 * Z) * Y;
			a3 = (-5.5711e-5 - 3.52836e-6 * Y + 8.86148e-9 * Z) * Z * Z;
			a4 = (-7.561e1 - 4.76816e-4 * Z - 6.48859 * Y) * Y * Y;
			a5 = 6.72387e4 + 3.2839 * Z;
			a6 = (3.55009e4 + 2.72616 * Z) * Y;
			a7 = (2.13714e-3 + 3.42377e-4 * Y - 6.84897e-8 * Z) * Z * Z;
			a8 = (6.50886e3 + 3.8056e-1 * Z + 4.14116e2 * Y) * Y * Y;
			a9 = exp(2.978e1 + 5.415 * Y + 1.713e-3 * Z + 3.115e-4 * Y * Z);
			F = a1 + a2 + a3 + a4 + (a5 + a6 + a7 + a8) / (1 - a9);
		}
		else
		{
			a1 = -6.4029e3 + 6.24254e3 * Z;
			a2 = (1.03279e2 - 8.73181e1 * Z) * Y;
			a3 = (-2.02865e3 + 1.71878e1 * Y + 2.19907e2 * Z) * Z * Z;
			a4 = (-1.22397e1 + 3.5783 * Z - 1.27953e-1 * Y) * Y * Y;
			F = a1 + a2 + a3 + a4;
		}

		return 1.74858e-5 * F;
	}

	double T(double e, double rho)
	{

	}
}
